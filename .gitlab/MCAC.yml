build-debug:
  stage: Build MCAC
  script:
    - pwd
    - ls -l
    - mkdir build
    - cd build
    - cmake -DWITH_SBL=OFF -DCMAKE_BUILD_TYPE=Debug -DDEBUG_MCAC=ON -DWITH_PYTHON=OFF .. 
    - make -j
  only:
    changes:
      - .gitlab/MCAC.yml
      - src/**/*
      - include/**/*
      - cmake/**/*
      - CMakeLists.txt
  artifacts:
    paths:
      - bin/Debug/MCAC
      - ext_bin


build-release:
  stage: Build MCAC
  script:
    - pwd
    - ls -l
    - mkdir build
    - cd build
    - cmake -DWITH_SBL=OFF -DCMAKE_BUILD_TYPE=Release -DDEBUG_MCAC=ON -DWITH_PYTHON=OFF ..
    - make -j
  only:
    changes:
      - .gitlab/MCAC.yml
      - src/**/*
      - include/**/*
      - cmake/**/*
      - CMakeLists.txt
  artifacts:
    paths:
      - bin/Release/MCAC
      - ext_bin

mcac_tests:
  stage: Test
  script:
    - echo "Testing MCAC occurs here"
  only:
    changes:
      - .gitlab/MCAC.yml
      - .gitlab/pyMCAC.yml
      - src/**/*
      - include/**/*
      - pymcac/**/*
      - cmake/**/*
      - CMakeLists.txt
      - venv/**/*
  needs: ["build-python"]
  dependencies:
    - build-python
