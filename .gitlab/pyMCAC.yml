.python_init: &python_init
  - pwd
  - ls -l
  - python3 -V               # Print out python version for debugging
  - python3 -m venv venv
  - source venv/bin/activate
  - pip install -r requirements.txt
  - pip install .

mypy:
  stage: Static Analysis
  script:
    - *python_init
    - pip install mypy
    - mypy
  only:
    changes:
      - pymcac/**/*
  needs: ["build-Release"]
  dependencies:
    - build-Release

flake8:
  stage: Static Analysis
  script:
    - *python_init
    - pip install flake8
    - flake8
  only:
    changes:
      - pymcac/**/*
  needs: ["build-Release"]
  dependencies:
    - build-Release

pylint:
  stage: Static Analysis
  #allow_failure: true
  script:
    - *python_init
    - pip install pylint
    - pylint -d C0301 bild/*.py
  only:
    changes:
      - pymcac/**/*
  needs: ["build-Release"]
  dependencies:
    - build-Release

isort:
  stage: Static Analysis
  #allow_failure: true
  script:
    - *python_init
    - pip install isort
    - isort .
  only:
    changes:
      - pymcac/**/*
  needs: ["build-Release"]
  dependencies:
    - build-Release

black:
  stage: Static Analysis
  #allow_failure: true
  script:
    - *python_init
    - pip install black
    - black .
  only:
    changes:
      - pymcac/**/*
  needs: ["build-Release"]
  dependencies:
    - build-Release

pymcac_tests:
  stage: Test
  script:
    - *python_init
    - pip install pytest
    - export PYTHONPATH="$PYTHONPATH:."
    - python -c "import sys;print(sys.path)"
    - pytest
  only:
    changes:
      - pymcac/**/*
  needs: ["build-Release"]
  dependencies:
    - build-Release
